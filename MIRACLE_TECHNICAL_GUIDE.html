<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MIRACLE TECHNICAL GUIDE</title>
    <link rel="stylesheet" href="miracle.css" />
    <style>
      body {
        line-height: 1.7;
        font-size: 13px;
      }
      p,
      li {
        margin-bottom: 6px;
      }
      pre,
      code {
        line-height: 1.6;
        padding: 6px 10px;
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>MIRACLE TECHNICAL GUIDE</h1>
        <p>
          ç”»é¢æ“ä½œã‚’ã€Œèª°ãŒãƒ»ã„ã¤ãƒ»ã©ã“ã§ãƒ»ä½•ã‚’ã—ãŸã‹ã€ã¾ã§è¿½è·¡ã™ã‚‹å®Ÿæ³ãƒ­ã‚°ã€‚ã‚³ãƒãƒ³ãƒ‰ /
          ãƒ•ã‚¡ã‚¤ãƒ« / state &amp; API ã‚’è‰²ä»˜ããƒãƒƒã‚¸ã§ç¤ºã—ã€æ“ä½œâ†’stateâ†’APIâ†’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä¸€æ°—ã«æŠŠæ¡ã§ãã¾ã™ã€‚
        </p>
      </header>

      <section class="hero">
        <h2>ğŸ“¦ äº‹å‰æº–å‚™</h2>
        <p>
          <span class="badge badge-outline badge-command">ç·‘ = ã‚³ãƒãƒ³ãƒ‰</span>
          <span class="badge badge-outline badge-file">é’ = ãƒ•ã‚¡ã‚¤ãƒ« / ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</span>
          <span class="badge badge-outline badge-state">ç´« = state æ›´æ–° / API å‡¦ç†</span>
        </p>
        <p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ãƒ­ãƒ³ãƒˆ / ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•ã—ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ã€‚</p>
        <pre class="code-stack">cd frontend
npm install
npm run dev</pre>
        <pre class="code-stack">cd backend
bundle install
rails db:setup
rails s -p 3002</pre>
        <ul>
          <li><code>.env.local</code> ã« <code>NEXT_PUBLIC_API_URL=http://localhost:3002/api/v1</code></li>
          <li><code>$TOKEN</code> ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œã® JWT ã‚’ã‚»ãƒƒãƒˆï¼ˆä»¥ä¸‹ã® curl ä¾‹ã§ä½¿ç”¨ï¼‰</li>
        </ul>
      </section>

      <section id="step1">
        <h2>1. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸è¡¨ç¤º</h2>
        <table>
          <tr>
            <th>æ“ä½œ</th>
            <th>è£å´</th>
          </tr>
          <tr>
            <td><code>http://localhost:3000/</code> ã‚’é–‹ã</td>
            <td>
              Next.js dev server ãŒ <span class="badge badge-file">frontend/app/page.tsx</span> ã‚’æç”»
            </td>
          </tr>
          <tr>
            <td>`useAuth()` ãŒç™ºç«</td>
            <td>
              <span class="badge badge-file">frontend/app/layout.tsx</span> å†…ã®
              <code>AuthProvider</code> ãŒ <code>localStorage.currentUser</code> ã‚’ç¢ºèª
            </td>
          </tr>
          <tr>
            <td>ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®å ´åˆ</td>
            <td><span class="badge badge-state">router.push('/dashboard')</span> ã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</td>
          </tr>
          <tr>
            <td>æœªãƒ­ã‚°ã‚¤ãƒ³ã®å ´åˆ</td>
            <td>ãƒ’ãƒ¼ãƒ­ãƒ¼ UI ã‚’ãã®ã¾ã¾æç”»</td>
          </tr>
        </table>
        <p><span class="badge badge-command">curl -I http://localhost:3000/</span></p>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><code>curl -I</code> ã¯ HTTP ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã€‚ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒã‚§ãƒƒã‚¯ã«ä¾¿åˆ©ã§ã™ã€‚</li>
            <li>
              <span class="badge badge-file">frontend/app/page.tsx</span> ã¯ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚<code>useAuth</code>
              ã§èªè¨¼çŠ¶æ…‹ã‚’ç›£è¦–ã—ã¦ã„ã¾ã™ã€‚
            </li>
          </ul>
        </div>
      </section>

      <section id="step2">
        <h2>2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¼šå“¡ç™»éŒ²</h2>
        <ol class="steps">
          <li>ãƒ•ã‚©ãƒ¼ãƒ ã« <code>hanako@example.com</code> / <code>password</code> ã‚’å…¥åŠ› â†’ <span class="badge badge-state">setEmail/setPassword/setRole</span></li>
          <li>ã€Œæ–°è¦ä¼šå“¡ç™»éŒ²ã€â†’ <span class="badge badge-state">useAuth().register()</span></li>
          <li><span class="badge badge-state">axios.post('/auth/register')</span> ã§ Rails ã¸é€ä¿¡</li>
          <li>Rails <code>Api::V1::RegistrationsController</code> ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ</li>
          <li>ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã® JWT ã‚’ <code>localStorage</code> ã«ä¿å­˜</li>
          <li><span class="badge badge-state">router.push('/dashboard')</span></li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ `setEmail/setPassword/setRole` ãŒãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã‚’ state ã«ä¿æŒã€‚</li>
            <li><strong>2</strong> â€¦ ã€Œæ–°è¦ä¼šå“¡ç™»éŒ²ã€ã§ <code>handleSubmit â†’ useAuth().register()</code> ãŒå‘¼ã°ã‚Œã‚‹ã€‚</li>
            <li><strong>3</strong> â€¦ <code>axios.post('/auth/register')</code> ãŒ Devise/RegistrationsController ã¸ JSON ã‚’é€ä¿¡ã€‚</li>
            <li><strong>4</strong> â€¦ Rails ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’DBã«ä½œæˆã€‚</li>
            <li><strong>5</strong> â€¦ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ <code>Authorization: Bearer ...</code> ã‚’ <code>localStorage.authToken</code> ã«ä¿å­˜ã€‚</li>
            <li><strong>6</strong> â€¦ <code>router.push('/dashboard')</code> ã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸é·ç§»ã€‚</li>
          </ul>
          <p><strong>ã‚³ãƒãƒ³ãƒ‰ã®æ„å‘³:</strong> curl ä¾‹ã¯ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¨åŒã˜ JSON ã‚’é€ã‚Šã€CLI ã‹ã‚‰ Devise ãŒ JWT ã‚’è¿”ã™ã‹ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚</p>
        </div>
        <p><span class="badge badge-command">curl -X POST http://localhost:3002/api/v1/auth/register -H 'Content-Type: application/json' -d '{"user":{"email":"hanako@example.com","password":"password","role":"user","nickname":"èŠ±å­"}}'</span></p>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/app/(auth)/register/page.tsx</span> â€¦ æ–°è¦ç™»éŒ²ç”»é¢ã®ãƒ•ã‚©ãƒ¼ãƒ ã€‚</li>
            <li><span class="badge badge-file">frontend/lib/AuthContext.tsx</span> â€¦ <code>register</code> ãŒ API ã‚’å‘¼ã³ã€JWT ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã€‚</li>
            <li>ä¸Šè¨˜ <code>curl</code> ã¯ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¨åŒã˜ JSON ã‚’æŠ•ã’ã‚‹ãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒãƒ³ãƒ‰ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step3">
        <h2>3. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</h2>
        <table>
          <tr>
            <th>Step</th>
            <th>ãƒ•ãƒ­ãƒ³ãƒˆ</th>
            <th>ã‚µãƒ¼ãƒãƒ¼</th>
          </tr>
          <tr>
            <td>/profile è¡¨ç¤º</td>
            <td><code>useEffect</code> ã§ `currentUser` ã‚’ãƒã‚§ãƒƒã‚¯ã—æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ `/login`</td>
            <td>â€”</td>
          </tr>
          <tr>
            <td>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—</td>
            <td><span class="badge badge-state">fetchProfile()</span> â†’ `GET /users/me`</td>
            <td><code>UsersController#show</code></td>
          </tr>
          <tr>
            <td>å…¥åŠ›ç·¨é›†</td>
            <td><span class="badge badge-state">setNickname/setBio/setPreviewUrl</span></td>
            <td>â€”</td>
          </tr>
          <tr>
            <td>ç”»åƒé¸æŠ</td>
            <td><span class="badge badge-state">handleFileChange</span> ãŒ validation</td>
            <td>â€”</td>
          </tr>
          <tr>
            <td>ä¿å­˜</td>
            <td><span class="badge badge-state">handleSubmit</span> â†’ FormData ã§é€ä¿¡</td>
            <td>`PUT /users/me`</td>
          </tr>
          <tr>
            <td>æˆåŠŸ</td>
            <td><code>localStorage.currentUser</code> æ›´æ–° + Toast</td>
            <td><code>UsersController#update</code></td>
          </tr>
        </table>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><code>curl ... -F</code> ã¯ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆé€ä¿¡ã€‚ç”»åƒãªã©ã®ãƒã‚¤ãƒŠãƒªã‚’æ·»ä»˜ã§ãã‚‹ã€‚</li>
            <li><span class="badge badge-file">frontend/app/profile/page.tsx</span> â€¦ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢ã®æœ¬ä½“ã€‚</li>
            <li><span class="badge badge-state">handleFileChange</span> â€¦ 5MBè¶…ã‚„éç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¼¾ããŸã‚ã®ã‚¬ãƒ¼ãƒ‰å‡¦ç†ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step4">
        <h2>4. å¤¢ã®æŠ•ç¨¿ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰</h2>
        <ol class="steps">
          <li>ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ã€Œä¸–ç•Œä¸€å‘¨æ—…è¡Œã€â†’ <span class="badge badge-state">setContent</span></li>
          <li>ã‚«ãƒ†ã‚´ãƒª/äºˆç®—ã‚’é¸æŠ â†’ <span class="badge badge-state">setCategoryId/setBudgetRange</span></li>
          <li>ã€ŒæŠ•ç¨¿ã™ã‚‹ã€â†’ <span class="badge badge-state">handleSubmit â†’ onSubmit</span></li>
          <li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® <span class="badge badge-state">handlePostDream</span> ãŒ <span class="badge badge-state">dreamsApi.createDream()</span></li>
          <li>Rails `DreamsController#create` ãŒä¿å­˜ â†’ JSON ã§è¿”å´</li>
          <li><span class="badge badge-state">setDreams([æ–°ã—ã„å¤¢, ...])</span> ã§å³åæ˜ </li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ <code>setContent</code> ã§å…¥åŠ›ã‚’ä¿æŒã€‚</li>
            <li><strong>2</strong> â€¦ <code>setCategoryId/setBudgetRange</code> ãŒã‚«ãƒ†ã‚´ãƒª/äºˆç®—ã‚’ä¿æŒã€‚</li>
            <li><strong>3</strong> â€¦ ã€ŒæŠ•ç¨¿ã™ã‚‹ã€ã§ <code>handleSubmit â†’ onSubmit</code> ãŒç™ºç«ã—ã€è¦ªã¸å€¤ã‚’æ¸¡ã™ã€‚</li>
            <li><strong>4</strong> â€¦ è¦ªã® <code>handlePostDream</code> ãŒ <code>dreamsApi.createDream()</code> ã‚’å‘¼ã³å‡ºã™ã€‚</li>
            <li><strong>5</strong> â€¦ Rails <code>DreamsController#create</code> ãŒ DB ã«ä¿å­˜ã—ã¦ JSON ã‚’è¿”ã™ã€‚</li>
            <li><strong>6</strong> â€¦ <code>setDreams([æ–°ã—ã„å¤¢, ...])</code> ã§ä¸€è¦§ã«å³åº§ã«è¿½åŠ ã€‚</li>
          </ul>
        </div>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/components/dream/DreamPostModal.tsx</span> â€¦ ãƒ¢ãƒ¼ãƒ€ãƒ« UI ã¨å…¥åŠ›æ¤œè¨¼ã€‚</li>
            <li><span class="badge badge-file">frontend/app/dashboard/page.tsx</span> â€¦ å¤¢ä¸€è¦§ã¨ state ç®¡ç†ã€‚</li>
            <li><span class="badge badge-state">dreamsApi.createDream</span> â€¦ `POST /dreams` ã‚’å‘¼ã³å‡ºã™ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚</li>
          </ul>
        </div>
      </section>

      <!-- Steps 5-11 -->
      <section id="step5">
        <h2>5. ä¼æ¥­ãƒ­ã‚°ã‚¤ãƒ³</h2>
        <ol class="steps">
          <li>ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ› â†’ <span class="badge badge-state">setEmail/setPassword</span></li>
          <li>ã€Œãƒ­ã‚°ã‚¤ãƒ³ã€â†’ <span class="badge badge-state">useAuth().login()</span></li>
          <li><span class="badge badge-state">axios.post('/auth/login')</span> ã§ JWT ã‚’å–å¾—</li>
          <li><span class="badge badge-state">router.push('/dashboard')</span></li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ `setEmail/setPassword` ã§å…¥åŠ›å€¤ã‚’ä¿æŒã€‚</li>
            <li><strong>2</strong> â€¦ ã€Œãƒ­ã‚°ã‚¤ãƒ³ã€ã§ <code>handleSubmit â†’ useAuth().login()</code>ã€‚</li>
            <li><strong>3</strong> â€¦ <code>axios.post('/auth/login')</code> ãŒ JWT ã‚’å—ã‘å–ã‚Šã€<code>localStorage</code> ã«ä¿å­˜ã€‚</li>
            <li><strong>4</strong> â€¦ role ãŒ <code>company</code> ã®ãŸã‚ä¼æ¥­å‘ã‘ UI ãŒè§£æ”¾ã•ã‚Œã‚‹ã€‚</li>
          </ul>
        </div>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/app/(auth)/login/page.tsx</span> â€¦ ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã€‚Google OAuth ãƒœã‚¿ãƒ³ã‚‚ã“ã“ã€‚</li>
            <li>ä¼æ¥­å‘ã‘ UI ã¯ `user.role === 'company'` ã§å‡ºã—åˆ†ã‘ã¦ã„ã‚‹ãŸã‚ã€role ãŒæ­£ã—ãè¿”ã£ã¦ã„ã‚‹ã‹ãŒé‡è¦ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step6">
        <h2>6. å¤¢ã®æ¤œç´¢ï¼ˆä¼æ¥­ï¼‰</h2>
        <table>
          <tr><th>æ“ä½œ</th><th>å‡¦ç†</th></tr>
          <tr><td>ã‚«ãƒ†ã‚´ãƒªé¸æŠ</td><td><span class="badge badge-state">setSelectedCategory(4)</span></td></tr>
          <tr><td>è‡ªå‹•æ¤œç´¢</td><td><span class="badge badge-state">fetchDreams({category_id:4})</span></td></tr>
          <tr><td>API</td><td><span class="badge badge-state">dreamsApi.getDreams</span> â†’ `GET /dreams?category_id=4`</td></tr>
          <tr><td>è¡¨ç¤º</td><td><span class="badge badge-state">setDreams(response.data)</span></td></tr>
          <tr><td>å‚™è€ƒ</td><td>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã¯æ—¢çŸ¥ã®ä¸å…·åˆ â†’ ã‚«ãƒ†ã‚´ãƒªã§å›é¿</td></tr>
        </table>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³ã§ <code>setSelectedCategory</code> ã‚’æ›´æ–°ã€‚</li>
            <li><strong>2</strong> â€¦ state å¤‰æ›´ã‚’ãƒ•ãƒƒã‚¯ã« <code>fetchDreams</code> ãŒå†å®Ÿè¡Œã€‚</li>
            <li><strong>3</strong> â€¦ <code>dreamsApi.getDreams</code> ãŒ <code>GET /dreams?category_id=...</code> ã‚’å‘¼ã³ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å–å¾—ã€‚</li>
            <li><strong>4</strong> â€¦ <code>setDreams(response.data)</code> ã§ä¸€è¦§ã«åæ˜ ã—ã€ææ¡ˆã¸é€²ã‚ã‚‹ã€‚</li>
          </ul>
        </div>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul><li><span class="badge badge-state">fetchDreams</span> å†…ã§ä¼æ¥­/ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒæ–¹ã®å¤¢ä¸€è¦§ã‚’æ‰±ã†ãŸã‚ã€ç„¡é§„ãª API å‘¼ã³å‡ºã—ãŒç„¡ã„ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨æ”¹å–„ãƒã‚¤ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‹ã€‚</li></ul>
        </div>
      </section>

      <section id="step7">
        <h2>7. ææ¡ˆé€ä¿¡ï¼ˆä¼æ¥­ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰</h2>
        <ol class="steps">
          <li>å…¥åŠ› â†’ <span class="badge badge-state">setTitle/setContent/setPrice</span></li>
          <li>é€ä¿¡ â†’ <span class="badge badge-state">handleSubmit</span></li>
          <li>è¦ªãŒ <span class="badge badge-state">proposalsApi.createProposal</span></li>
          <li>`POST /proposals` â†’ Rails `ProposalsController#create`</li>
          <li><span class="badge badge-state">setProposals([...prev, data])</span></li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ ãƒ¢ãƒ¼ãƒ€ãƒ«å…¥åŠ›ã‚’ <code>setTitle/setContent/setPrice</code> ã«ä¿æŒã€‚</li>
            <li><strong>2</strong> â€¦ é€ä¿¡ã§ <code>handleSubmit</code> ãŒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€šéã™ã‚‹ã¨è¦ªã¸å€¤ã‚’æ¸¡ã™ã€‚</li>
            <li><strong>3ã€œ5</strong> â€¦ è¦ªãŒ <code>proposalsApi.createProposal</code> ã‚’å‘¼ã³ã€<code>dream_id</code> + <code>proposal</code> ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ Rails ã¸é€ä¿¡ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ <code>setProposals</code> ã«è¿½åŠ ã€‚</li>
          </ul>
          <p><strong>ã‚³ãƒãƒ³ãƒ‰ã®æ„å‘³:</strong> ä¸‹è¨˜ã® curl ä¾‹ã§ã€ä¼æ¥­ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã® JWT ã‚’ä½¿ã£ã¦ <code>POST /proposals</code> ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚</p>
        </div>
        <p><span class="badge badge-command">curl -X POST http://localhost:3002/api/v1/proposals -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" -d '{"dream_id":1,"proposal":{"title":"ã‚¢ãƒã‚¾ãƒ³çå‘³ä½“é¨“","content":"å¸Œå°‘é£Ÿæã‚’æä¾›...","price":50000}}'</span></p>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/components/proposal/ProposalSendModal.tsx</span> â€¦ å…¥åŠ›ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¾ã¨ã‚ãŸãƒ¢ãƒ¼ãƒ€ãƒ«ã€‚</li>
            <li><span class="badge badge-state">proposalsApi.createProposal</span> â€¦ `dream_id` ã‚’ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã€`proposal` ã‚’ãƒã‚¹ãƒˆã—ã¦é€ã‚‹å½¢ã‚’çµ±ä¸€ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step8">
        <h2>8. ã‚¹ãƒãƒ›é€šçŸ¥ç¢ºèª</h2>
        <ol class="steps">
          <li>ãƒ™ãƒ«ã‚’ã‚¿ãƒƒãƒ— â†’ <span class="badge badge-state">toggleDropdown()</span></li>
          <li>åˆå› â†’ <span class="badge badge-state">initializeNotifications()</span></li>
          <li><span class="badge badge-state">loadNotifications()</span> / <span class="badge badge-state">getNotificationsByUserId</span></li>
          <li>æœªèª­æ•° â†’ <span class="badge badge-state">getUnreadCount()</span></li>
          <li>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  push ã¯æœªå®Ÿè£… â†’ ãƒªãƒ­ãƒ¼ãƒ‰ã§æ›´æ–°</li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1è¡Œç›®</strong> â€¦ ã‚¹ãƒãƒ›ã§ãƒ™ãƒ«ã‚’é–‹ãã¨ <code>toggleDropdown()</code> ãŒèµ·å‹•ã€‚</li>
            <li><strong>2è¡Œç›®</strong> â€¦ åˆå›ãªã‚‰ <code>initializeNotifications()</code> ãŒ localStorage ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã€‚</li>
            <li><strong>3ã€œ4è¡Œç›®</strong> â€¦ <code>loadNotifications()</code> ãŒ <code>getNotificationsByUserId</code> ã¨ <code>getUnreadCount</code> ã‚’å‘¼ã³ã€æœªèª­ãƒãƒƒã‚¸ã‚’æ›´æ–°ã€‚</li>
            <li><strong>5è¡Œç›®</strong> â€¦ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  push ã¯æœªå®Ÿè£…ãªã®ã§ã€å†è¡¨ç¤ºã‚„ãƒªãƒ­ãƒ¼ãƒ‰ã§æœ€æ–°çŠ¶æ…‹ã«ã—ã¾ã™ã€‚</li>
          </ul>
        </div>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/components/notifications/NotificationBell.tsx</span> â€¦ é€šçŸ¥ãƒ™ãƒ«ã® UI ã¨å‡¦ç†ã€‚</li>
            <li><span class="badge badge-file">frontend/lib/notifications.ts</span> â€¦ localStorage ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒƒã‚¯é€šçŸ¥ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step9">
        <h2>9. é€šçŸ¥ã‚’æ—¢èª­ã«ã™ã‚‹</h2>
        <ol class="steps">
          <li>é€šçŸ¥ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯ â†’ <span class="badge badge-state">handleMarkAsRead(id)</span></li>
          <li><span class="badge badge-state">markAsRead</span> ãŒ localStorage ã‚’æ›´æ–°</li>
          <li><span class="badge badge-state">loadNotifications()</span> ã§å†è¡¨ç¤º</li>
          <li>ãƒãƒƒã‚¸ãŒæ¶ˆãˆã€ä»Šå¾Œã¯ `related_type` ã§è©³ç´°è¡¨ç¤ºäºˆå®š</li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1è¡Œç›®</strong> â€¦ é€šçŸ¥ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯ã§ <code>handleMarkAsRead</code> ãŒèµ·å‹•ã—ã€æ—¢èª­çŠ¶æ…‹ã‚’æ›´æ–°ã€‚</li>
            <li><strong>2è¡Œç›®</strong> â€¦ <code>markAsRead</code> ãŒ localStorage ã®å¯¾è±¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ›ãˆã‚‹ã€‚</li>
            <li><strong>3ã€œ4è¡Œç›®</strong> â€¦ <code>loadNotifications()</code> ã§ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿ã—ã€æœªèª­ãƒ•ãƒ©ã‚°ã¨ä»¶æ•°ãŒå³æ™‚ã«å¤‰ã‚ã‚‹ã€‚</li>
          </ul>
        </div>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li>`e.stopPropagation()` ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ã‚¯ãƒªãƒƒã‚¯å‡¦ç†ã‚’æ­¢ã‚ã¦ã„ã‚‹ãŸã‚ã€é–‹ã„ãŸã¾ã¾æ—¢èª­ã«ã§ãã‚‹ã€‚</li>
            <li><span class="badge badge-state">markAsRead</span> ã¯ `read_at` ã‚‚ä¿å­˜ã™ã‚‹ã®ã§ã€ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…æ™‚ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã«ã‚‚åˆ©ç”¨å¯èƒ½ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step10">
        <h2>10. ææ¡ˆæ‰¿èª</h2>
        <ol class="steps">
          <li>ã€Œæ‰¿èªã€â†’ `confirm`</li>
          <li><span class="badge badge-state">handleAcceptProposal(id)</span></li>
          <li><span class="badge badge-state">proposalsApi.acceptProposal</span> â†’ `POST /proposals/:id/accept`</li>
          <li>Rails ãŒ `status=accepted` + `ChatRoom` ã‚’ç”Ÿæˆ</li>
          <li><span class="badge badge-state">window.location.href = /chat/:id</span> ã§ãƒãƒ£ãƒƒãƒˆã¸</li>
          <li>ä¼æ¥­ã«ã¯æ‰¿èªé€šçŸ¥ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ UI ã¯ `accepted` è¡¨ç¤º</li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ ã€Œæ‰¿èªã€ã§ <code>confirm</code> ã«ã‚ˆã‚‹ç¢ºèªã‚’æŒŸã‚€ã€‚</li>
            <li><strong>2</strong> â€¦ OK ãªã‚‰ <code>handleAcceptProposal</code> ãŒå‡¦ç†ã‚’é–‹å§‹ã€‚</li>
            <li><strong>3</strong> â€¦ <code>proposalsApi.acceptProposal</code> ãŒ <code>POST /proposals/:id/accept</code> ã‚’å‘¼ã¶ã€‚</li>
            <li><strong>4</strong> â€¦ Rails ã§ <code>status=accepted</code> ã¨ <code>ChatRoom</code> ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚</li>
            <li><strong>5</strong> â€¦ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã® <code>chat_room.id</code> ã‚’ä½¿ã£ã¦ <code>/chat/:id</code> ã«é·ç§»ã€‚</li>
            <li><strong>6</strong> â€¦ ä¼æ¥­ã«ã¯æ‰¿èªé€šçŸ¥ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”»é¢ã¯ `accepted` è¡¨ç¤ºã«æ›´æ–°ã€‚</li>
          </ul>
          <p><strong>ã‚³ãƒãƒ³ãƒ‰ã®æ„å‘³:</strong> ä¸‹è¨˜ã® curl ã¯ JWT ã‚’ä»˜ä¸ã—ã¦ææ¡ˆã‚’æ‰¿èªã™ã‚‹å ´åˆã®ä¾‹ã€‚API ãŒ <code>chat_room</code> ã‚’è¿”ã™ã“ã¨ã‚’ CLI ã§ç¢ºèªã§ãã¾ã™ã€‚</p>
        </div>
        <p><span class="badge badge-command">curl -X POST http://localhost:3002/api/v1/proposals/12/accept -H "Authorization: Bearer $TOKEN"</span></p>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-state">handleAcceptProposal</span> ã¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§èª¤æ“ä½œã‚’é˜²æ­¢ã€‚</li>
            <li><span class="badge badge-state">proposalsApi.acceptProposal</span> ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ãƒãƒ£ãƒƒãƒˆæƒ…å ±ãŒå«ã¾ã‚Œã€é·ç§»å…ˆ URL ã‚’æ±ºå®šã™ã‚‹ã€‚</li>
          </ul>
        </div>
      </section>

      <section id="step11">
        <h2>11. ãƒãƒ£ãƒƒãƒˆ</h2>
        <ol class="steps">
          <li>`/chat` â†’ <span class="badge badge-state">fetchChatRooms()</span> (`GET /chat_rooms`)</li>
          <li>ãƒ«ãƒ¼ãƒ é¸æŠ â†’ `/chat/[id]` â†’ `GET /chat_rooms/:id/messages`</li>
          <li>å…¥åŠ› â†’ <span class="badge badge-state">setMessage</span></li>
          <li>é€ä¿¡ â†’ <span class="badge badge-state">POST /chat_rooms/:id/messages</span></li>
          <li>è¿”å´ãƒ‡ãƒ¼ã‚¿ã‚’ `setMessages` ã«æµã—ã€å¿…è¦ãªã‚‰ Action Cable / ãƒãƒ¼ãƒªãƒ³ã‚°ã‚’è¿½åŠ </li>
        </ol>
        <div class="hero">
          <p><strong>è©³ã—ã„å‹•ã:</strong></p>
          <ul>
            <li><strong>1</strong> â€¦ <code>fetchChatRooms()</code> ãŒ <code>GET /chat_rooms</code> ã‚’å‘¼ã³ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼/ä¼æ¥­ã«ç´ã¥ããƒ«ãƒ¼ãƒ ã®ã¿è¿”ã™ã€‚</li>
            <li><strong>2</strong> â€¦ ãƒ«ãƒ¼ãƒ ãƒªãƒ³ã‚¯ã§ <code>/chat/[id]</code> ã«ç§»å‹•ã—ã€<code>GET /chat_rooms/:id/messages</code> ã§å±¥æ­´ã‚’å–å¾—ã€‚</li>
            <li><strong>3</strong> â€¦ å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã§ <code>setMessage</code> ãŒ state ã‚’æ›´æ–°ã€‚</li>
            <li><strong>4</strong> â€¦ ã€Œé€ä¿¡ã€ã§ <code>POST /chat_rooms/:id/messages</code> ã‚’å‘¼ã³ã€ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã€‚</li>
            <li><strong>5</strong> â€¦ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ <code>setMessages</code> ã«æ¸¡ã—ã¦ UI ã‚’æ›´æ–°ã€‚å¿…è¦ãªã‚‰ Action Cable / ãƒãƒ¼ãƒªãƒ³ã‚°ã§æœ€æ–°åŒ–ã€‚</li>
          </ul>
          <p><strong>ã‚³ãƒãƒ³ãƒ‰ã®æ„å‘³:</strong> ä¸‹ã® curl ä¾‹ã§ã¯ <code>GET /chat_rooms</code> ã‚’ CLI ã§ç¢ºèªã§ãã€ã©ã®ãƒ«ãƒ¼ãƒ ãŒç´ã¥ãã‹ã‚’ãƒ‡ãƒãƒƒã‚°ã§ãã¾ã™ã€‚</p>
        </div>
        <p><span class="badge badge-command">curl -H "Authorization: Bearer $TOKEN" http://localhost:3002/api/v1/chat_rooms</span></p>
        <div class="omake">
          <h4>ğŸ“ ãŠã¾ã‘</h4>
          <ul>
            <li><span class="badge badge-file">frontend/app/chat/page.tsx</span> â€¦ ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ ä¸€è¦§ã€‚ãƒ€ãƒŸãƒ¼æœªèª­ãƒãƒƒã‚¸ãŒã‚ã‚‹ã®ã§æœ¬ç•ªæ™‚ã¯ API é€£æºã¸ç½®ãæ›ãˆã€‚</li>
            <li><span class="badge badge-file">frontend/app/chat/[id]/page.tsx</span> â€¦ å€‹åˆ¥ãƒãƒ£ãƒƒãƒˆã€‚ç¾åœ¨ã¯ãƒãƒ¼ãƒªãƒ³ã‚°ã§æœ€æ–°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—ã€‚</li>
          </ul>
        </div>
      </section>

      <section>
        <h2>ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«å›é¿</h2>
        <ul>
          <li>é€šçŸ¥ãŒæ›´æ–°ã•ã‚Œãªã„ â†’ Step8 ã®é€šã‚Šãƒ™ãƒ«ã‚’é–‰ã˜ã¦é–‹ã / ãƒªãƒ­ãƒ¼ãƒ‰</li>
          <li>API 401 â†’ <code>localStorage.authToken</code> ã‚’ã‚¯ãƒªã‚¢ã—å†ãƒ­ã‚°ã‚¤ãƒ³</li>
          <li>ãƒ•ãƒ­ãƒ³ãƒˆã®ã¿æ›´æ–° â†’ <code>npm run dev</code> ã‚’å†èµ·å‹•</li>
          <li>Rails 500 â†’ <code>backend/log/development.log</code> ã‚’ç¢ºèª</li>
        </ul>
      </section>
    </main>
  </body>
</html>
